var html=function(h){function S(a){if(z.hasOwnProperty(a))return z[a];var b=a.match(T);return b?String.fromCharCode(parseInt(b[1],10)):(b=a.match(U))?String.fromCharCode(parseInt(b[1],16)):s&&V.test(a)?(s.innerHTML="&"+a+";",b=s.textContent,z[a]=b):"&"+a+";"}function W(a,b){return S(b)}function A(a){return a.replace(X,W)}function C(a){return(""+a).replace(Y,"&amp;").replace(D,"&lt;").replace(E,"&gt;").replace(Z,"&#34;")}function F(a){return a.replace($,"&amp;$1").replace(D,"&lt;").replace(E,"&gt;")}
function G(a){var b={cdata:a.cdata||a.cdata,comment:a.comment||a.comment,endDoc:a.endDoc||a.endDoc,endTag:a.endTag||a.endTag,pcdata:a.pcdata||a.pcdata,rcdata:a.rcdata||a.rcdata,startDoc:a.startDoc||a.startDoc,startTag:a.startTag||a.startTag};return function(a,f){var c;var p=/(<\/|<\!--|<[!?]|[&<>])/g;c=a+"";if(aa)c=c.split(p);else{for(var e=[],g=0,h;null!==(h=p.exec(c));)e.push(c.substring(g,h.index)),e.push(h[0]),g=h.index+h[0].length;e.push(c.substring(g));c=e}H(b,c,0,{noMoreGT:!1,noMoreEndComments:!1},
f)}}function q(a,b,d,f,c){return function(){H(a,b,d,f,c)}}function H(a,b,d,f,c){try{a.startDoc&&0==d&&a.startDoc(c);for(var p,e,g,m=b.length;d<m;){var l=b[d++],t=b[d];switch(l){case "&":ba.test(t)?(a.pcdata&&a.pcdata("&"+t,c,n,q(a,b,d,f,c)),d++):a.pcdata&&a.pcdata("&amp;",c,n,q(a,b,d,f,c));break;case "</":if(p=/^([-\w:]+)[^\'\"]*/.exec(t))if(p[0].length===t.length&&">"===b[d+1])d+=2,g=p[1].toLowerCase(),a.endTag&&a.endTag(g,c,n,q(a,b,d,f,c));else{var k=b,u=d,v=a,r=c,B=n,z=f,s=I(k,u);s?(v.endTag&&
v.endTag(s.name,r,B,q(v,k,u,z,r)),d=s.next):d=k.length}else a.pcdata&&a.pcdata("&lt;/",c,n,q(a,b,d,f,c));break;case "<":if(p=/^([-\w:]+)\s*\/?/.exec(t))if(p[0].length===t.length&&">"===b[d+1]){d+=2;g=p[1].toLowerCase();a.startTag&&a.startTag(g,[],c,n,q(a,b,d,f,c));var x=h.ELEMENTS[g];x&J&&(d=K(b,{name:g,next:d,eflags:x},a,c,n,f))}else{var k=b,u=a,v=c,r=n,B=f,w=I(k,d);w?(u.startTag&&u.startTag(w.name,w.attrs,v,r,q(u,k,w.next,B,v)),d=w.eflags&J?K(k,w,u,v,r,B):w.next):d=k.length}else a.pcdata&&a.pcdata("&lt;",
c,n,q(a,b,d,f,c));break;case "\x3c!--":if(!f.noMoreEndComments){for(e=d+1;e<m&&(">"!==b[e]||!/--$/.test(b[e-1]));e++);if(e<m){if(a.comment){var y=b.slice(d,e).join("");a.comment(y.substr(0,y.length-2),c,n,q(a,b,e+1,f,c))}d=e+1}else f.noMoreEndComments=!0}f.noMoreEndComments&&a.pcdata&&a.pcdata("&lt;!--",c,n,q(a,b,d,f,c));break;case "<!":if(/^\w/.test(t)){if(!f.noMoreGT){for(e=d+1;e<m&&">"!==b[e];e++);e<m?d=e+1:f.noMoreGT=!0}f.noMoreGT&&a.pcdata&&a.pcdata("&lt;!",c,n,q(a,b,d,f,c))}else a.pcdata&&a.pcdata("&lt;!",
c,n,q(a,b,d,f,c));break;case "<?":if(!f.noMoreGT){for(e=d+1;e<m&&">"!==b[e];e++);e<m?d=e+1:f.noMoreGT=!0}f.noMoreGT&&a.pcdata&&a.pcdata("&lt;?",c,n,q(a,b,d,f,c));break;case ">":a.pcdata&&a.pcdata("&gt;",c,n,q(a,b,d,f,c));break;case "":break;default:a.pcdata&&a.pcdata(l,c,n,q(a,b,d,f,c))}}a.endDoc&&a.endDoc(c)}catch(A){if(A!==n)throw A;}}function K(a,b,d,f,c,p){var e=a.length;x.hasOwnProperty(b.name)||(x[b.name]=RegExp("^"+b.name+"(?:[\\s\\/]|$)","i"));for(var g=x[b.name],m=b.next,l=b.next+1;l<e&&
("</"!==a[l-1]||!g.test(a[l]));l++);l<e&&(l-=1);e=a.slice(m,l).join("");if(b.eflags&h.eflags.CDATA)d.cdata&&d.cdata(e,f,c,q(d,a,l,p,f));else if(b.eflags&h.eflags.RCDATA)d.rcdata&&d.rcdata(F(e),f,c,q(d,a,l,p,f));else throw Error("bug");return l}function I(a,b){var d=/^([-\w:]+)/.exec(a[b]),f={};f.name=d[1].toLowerCase();f.eflags=h.ELEMENTS[f.name];for(var c=a[b].substr(d[0].length),p=b+1,e=a.length;p<e&&">"!==a[p];p++)c+=a[p];if(!(e<=p)){for(var g=[];""!==c;)if(d=ca.exec(c))if(d[4]&&!d[5]||d[6]&&!d[7]){for(var d=
d[4]||d[6],m=!1,c=[c,a[p++]];p<e;p++){if(m){if(">"===a[p])break}else 0<=a[p].indexOf(d)&&(m=!0);c.push(a[p])}if(e<=p)break;c=c.join("")}else{var m=d[1].toLowerCase(),l;if(d[2]){l=d[3];var k=l.charCodeAt(0);if(34===k||39===k)l=l.substr(1,l.length-2);l=A(l.replace(da,""))}else l="";g.push(m,l);c=c.substr(d[0].length)}else c=c.replace(/^[\s\S][^a-z\s]*/,"");f.attrs=g;f.next=p+1;return f}}function L(a){var b,d,f=function(a,b){d||b.push(a)};return G({startDoc:function(a){b=[];d=!1},startTag:function(c,
f,e){if(!d&&h.ELEMENTS.hasOwnProperty(c)){var g=h.ELEMENTS[c];if(!(g&h.eflags.FOLDABLE)){var m=a(c,f);if(m){if("object"!==typeof m)throw Error("tagPolicy did not return object (old API?)");if("attribs"in m)f=m.attribs;else throw Error("tagPolicy gave no attribs");var l;"tagName"in m?(l=m.tagName,m=h.ELEMENTS[l]):(l=c,m=g);if(g&h.eflags.OPTIONAL_ENDTAG){var k=b[b.length-1];!k||k.orig!==c||k.rep===l&&c===l||e.push("</",k.rep,">")}g&h.eflags.EMPTY||b.push({orig:c,rep:l});e.push("<",l);c=0;for(k=f.length;c<
k;c+=2){var q=f[c],n=f[c+1];null!==n&&void 0!==n&&e.push(" ",q,'="',C(n),'"')}e.push(">");g&h.eflags.EMPTY&&!(m&h.eflags.EMPTY)&&e.push("</",l,">")}else d=!(g&h.eflags.EMPTY)}}},endTag:function(a,f){if(d)d=!1;else if(h.ELEMENTS.hasOwnProperty(a)){var e=h.ELEMENTS[a];if(!(e&(h.eflags.EMPTY|h.eflags.FOLDABLE))){if(e&h.eflags.OPTIONAL_ENDTAG)for(e=b.length;0<=--e;){var g=b[e].orig;if(g===a)break;if(!(h.ELEMENTS[g]&h.eflags.OPTIONAL_ENDTAG))return}else for(e=b.length;0<=--e&&b[e].orig!==a;);if(!(0>e)){for(g=
b.length;--g>e;){var k=b[g].rep;h.ELEMENTS[k]&h.eflags.OPTIONAL_ENDTAG||f.push("</",k,">")}e<b.length&&(a=b[e].rep);b.length=e;f.push("</",a,">")}}}},pcdata:f,rcdata:f,cdata:f,endDoc:function(a){for(;b.length;b.length--)a.push("</",b[b.length-1].rep,">")}})}function M(a,b,d,f,c){if(!c)return null;try{var h=URI.parse(""+a);if(h&&(!h.hasScheme()||ea.test(h.getScheme()))){var e=c(h,b,d,f);return e?e.toString():null}}catch(g){}return null}function r(a,b,d,f,c){d||a(b+" removed",{change:"removed",tagName:b});
if(f!==c){var h="changed";f&&!c?h="removed":!f&&c&&(h="added");a(b+"."+d+" "+h,{change:h,tagName:b,attribName:d,oldValue:f,newValue:c})}}function N(a,b,d){b=b+"::"+d;if(a.hasOwnProperty(b))return a[b];b="*::"+d;if(a.hasOwnProperty(b))return a[b]}function O(a,b,d,f,c){for(var k=0;k<b.length;k+=2){var e=b[k],g=b[k+1],m=g,l=null,n;if((n=a+"::"+e,h.ATTRIBS.hasOwnProperty(n))||(n="*::"+e,h.ATTRIBS.hasOwnProperty(n)))l=h.ATTRIBS[n];if(null!==l)switch(l){case h.atype.NONE:break;case h.atype.SCRIPT:g=null;
c&&r(c,a,e,m,g);break;case h.atype.STYLE:if("undefined"===typeof y){g=null;c&&r(c,a,e,m,g);break}var q=[];y(g,{declaration:function(a,b){var c=a.toLowerCase();P(c,b,d?function(a){return M(a,h.ueffects.SAME_DOCUMENT,h.ltypes.SANDBOXED,{TYPE:"CSS",CSS_PROP:c},d)}:null);b.length&&q.push(c+": "+b.join(" "))}});g=0<q.length?q.join(" ; "):null;c&&r(c,a,e,m,g);break;case h.atype.ID:case h.atype.IDREF:case h.atype.IDREFS:case h.atype.GLOBAL_NAME:case h.atype.LOCAL_NAME:case h.atype.CLASSES:g=f?f(g):g;c&&
r(c,a,e,m,g);break;case h.atype.URI:g=M(g,N(h.URIEFFECTS,a,e),N(h.LOADERTYPES,a,e),{TYPE:"MARKUP",XML_ATTR:e,XML_TAG:a},d);c&&r(c,a,e,m,g);break;case h.atype.URI_FRAGMENT:g&&"#"===g.charAt(0)?(g=g.substring(1),g=f?f(g):g,null!==g&&void 0!==g&&(g="#"+g)):g=null;c&&r(c,a,e,m,g);break;default:g=null,c&&r(c,a,e,m,g)}else g=null,c&&r(c,a,e,m,g);b[k+1]=g}return b}function Q(a,b,d){return function(f,c){if(h.ELEMENTS[f]&h.eflags.UNSAFE)d&&r(d,f,void 0,void 0,void 0);else return{attribs:O(f,c,a,b,d)}}}function R(a,
b){var d=[];L(b)(a,d);return d.join("")}var y,P;"undefined"!==typeof window&&(y=window.parseCssDeclarations,P=window.sanitizeCssProperty);var z={lt:"<",LT:"<",gt:">",GT:">",amp:"&",AMP:"&",quot:'"',apos:"'",nbsp:"\u00a0"},T=/^#(\d+)$/,U=/^#x([0-9A-Fa-f]+)$/,V=/^[A-Za-z][A-za-z0-9]+$/,s="undefined"!==typeof window&&window.document?window.document.createElement("textarea"):null,da=/\0/g,X=/&(#[0-9]+|#[xX][0-9A-Fa-f]+|\w+);/g,ba=/^(#[0-9]+|#[xX][0-9A-Fa-f]+|\w+);/,Y=/&/g,$=/&([^a-z#]|#(?:[^0-9x]|x(?:[^0-9a-f]|$)|$)|$)/gi,
D=/[<]/g,E=/>/g,Z=/\"/g,ca=/^\s*([-.:\w]+)(?:\s*(=)\s*((")[^"]*("|$)|(')[^']*('|$)|(?=[a-z][-\w]*\s*=)|[^"'\s]*))?/i,aa=3==="a,b".split(/(,)/).length,J=h.eflags.CDATA|h.eflags.RCDATA,n={},x={},ea=/^(?:https?|mailto)$/i,k={};k.escapeAttrib=k.escapeAttrib=C;k.makeHtmlSanitizer=k.makeHtmlSanitizer=L;k.makeSaxParser=k.makeSaxParser=G;k.makeTagPolicy=k.makeTagPolicy=Q;k.normalizeRCData=k.normalizeRCData=F;k.sanitize=k.sanitize=function(a,b,d,f){b=Q(b,d,f);return R(a,b)};k.sanitizeAttribs=k.sanitizeAttribs=
O;k.sanitizeWithPolicy=k.sanitizeWithPolicy=R;k.unescapeEntities=k.unescapeEntities=A;return k}(html4),html_sanitize=html.sanitize;"undefined"!==typeof window&&(window.html=html,window.html_sanitize=html_sanitize);